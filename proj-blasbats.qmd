```{r setup}
#| include: false
library(tidyverse)
library(sf)
library(terra)
```

# B. Lasbats {.unnumbered}

## Figure

```{r figdat}
#| message: false
#| warning: false
path <- "~/Documents/data/blasbats/"
ci <- st_read("~/Documents/data/blasbats/Archive/IC_coords.shp", quiet = T)
clust <- st_read("~/Documents/data/blasbats/Archive/sampling.shp", quiet = T)
sf_use_s2(FALSE)
clust_ctr <- clust %>% 
  group_by(clus) %>% 
  sample_n(1) %>% 
  st_centroid()
clust_ctr_df <- clust_ctr %>% 
  st_coordinates() %>% 
  as.data.frame() %>% 
  mutate(clust = clust_ctr$clus)
clim <- rast("~/Documents/data/CI/wc/wc2.1_10m_bioc_ACCESS-CM2_ssp126_2021-2040.tif")
```

```{r fig}
g <- ggplot() +
  tidyterra::geom_spatraster(data = clim[[1]], alpha = 0.5) +
  geom_sf(data = ci, fill = NA, linewidth = 1.5, col = "#454746") +
  geom_sf(data = clust, fill = NA, linewidth = 1.2, col = "black") +
  ggrepel::geom_text_repel(
    data = clust_ctr,
    aes(label = clus, geometry = geometry),
    stat = "sf_coordinates"
  ) +
  theme_bw() +
  scale_fill_viridis_c("T(Â°C)", na.value = NA)  +
  theme(axis.title = element_blank())
ggsave("~/Documents/data/blasbats/ex.png", g,
       dpi = 1000, width = 8, height = 9, bg = "white")
ggsave("~/Documents/data/blasbats/ex.pdf", g, 
       dpi = 1000, width = 8, height = 9)
```

```{r figshow}
g
```
